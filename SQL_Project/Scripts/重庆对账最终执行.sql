--DROP  TABLE GAMS_CARD_CHANGE ;
--CREATE TABLE GAMS_CARD_CHANGE_TEMP AS SELECT * FROM GAMS_CARD_CHANGE ;
--先备份gams_card_change
CREATE TABLE gams_card_change0423 AS SELECT * FROM gams_card_change;

--备份gams_card_change0407

CREATE TABLE gams_card_change0407bak AS SELECT * FROM gams_card_change0407;
--执行
CREATE TABLE GAMS_CARD_CHANGE_t AS SELECT * FROM GAMS_CARD_CHANGE gcc WHERE gcc.BIZTIME > to_date('2021-04-07 00:00:00','yyyy-mm-dd HH24:mi:ss');

INSERT
	INTO
	GAMS_CARD_CHANGE_t (ID,
	CARDID,
	CARDOBJECTID,
	BIZID,
	BIZTYPE,
	BIZTIME,
	ORG,
	JIZRQ,
	ZICFL,
	SHIYBM,
	SHIYZK,
	SHIYR,
	QUDFS,
	YONGTFL,
	CHANQXS,
	QUANSXZ,
	JIAZLX,
	CHUZXS,
	CUNFDD,
	JIAZ,
	JIAZ_Z,
	JIAZ_J,
	SHUL,
	SHUL_Z,
	SHUL_J,
	MIANJ,
	MIANJ_Z,
	MIANJ_J,
	BIANZQK,
	JIAOYSYFX,
	HANGYFL,
	SORTGB,
	BIZCODE,
	JIZQJ,
	HANGYDL,
	GRADE,
	NATURE,
	ZICFL_D,
	SORTGB_D,
	HANGYFL_D,
	HANGYDL_D,
	SHIYBM_D,
	SHIYR_D,
	CUNFDD_D,
	JIAOYSYFX_D,
	SHIYZK_D,
	QUDFS_D,
	BIANZQK_D,
	YONGTFL_D,
	CHANQXS_D,
	QUANSXZ_D,
	JIAZLX_D,
	JINGFKM_D,
	CAOZSJ,
	XIAOJBGYF,
	XIAOJBGYF_Z,
	XIAOJBGYF_J,
	XIAOJQZBGSYF,
	XIAOJQZBGSYF_Z,
	XIAOJQZBGSYF_J,
	XIAOJYWYF,
	XIAOJYWYF_Z,
	XIAOJYWYF_J,
	XIAOJIQTYF,
	XIAOJIQTYF_Z,
	XIAOJIQTYF_J,
	HANGYFLNEW,
	BIANDCZSXH,
	ZICFLCODE,
	CAIWJZRQ,
	FINALBILLID)
SELECT
	ID,
	CARDID,
	CARDOBJECTID,
	BIZID,
	BIZTYPE,
	BIZTIME,
	ORG,
	JIZRQ,
	ZICFL,
	SHIYBM,
	SHIYZK,
	SHIYR,
	QUDFS,
	YONGTFL,
	CHANQXS,
	QUANSXZ,
	JIAZLX,
	CHUZXS,
	CUNFDD,
	JIAZ,
	JIAZ_Z,
	JIAZ_J,
	SHUL,
	SHUL_Z,
	SHUL_J,
	MIANJ,
	MIANJ_Z,
	MIANJ_J,
	BIANZQK,
	JIAOYSYFX,
	HANGYFL,
	SORTGB,
	BIZCODE,
	JIZQJ,
	HANGYDL,
	GRADE,
	NATURE,
	ZICFL_D,
	SORTGB_D,
	HANGYFL_D,
	HANGYDL_D,
	SHIYBM_D,
	SHIYR_D,
	CUNFDD_D,
	JIAOYSYFX_D,
	SHIYZK_D,
	QUDFS_D,
	BIANZQK_D,
	YONGTFL_D,
	CHANQXS_D,
	QUANSXZ_D,
	JIAZLX_D,
	JINGFKM_D,
	CAOZSJ,
	XIAOJBGYF,
	XIAOJBGYF_Z,
	XIAOJBGYF_J,
	XIAOJQZBGSYF,
	XIAOJQZBGSYF_Z,
	XIAOJQZBGSYF_J,
	XIAOJYWYF,
	XIAOJYWYF_Z,
	XIAOJYWYF_J,
	XIAOJIQTYF,
	XIAOJIQTYF_Z,
	XIAOJIQTYF_J,
	HANGYFLNEW,
	BIANDCZSXH,
	ZICFLCODE,
	CAIWJZRQ,
	FINALBILLID
FROM gams_card_change0407bak;

--
DROP TABLE GAMS_CARD_CHANGE ;

CREATE TABLE GAMS_CARD_CHANGE AS SELECT * FROM GAMS_CARD_CHANGE_t;



DELETE CQDZGCZYXY_ZCGL.GAMS_CARD_CHANGE WHERE id IN (SELECT id FROM CQDZGCZYXY_ZCGL.GAMS_CARD_CHANGETEST);


INSERT
	INTO
	CQDZGCZYXY_ZCGL.GAMS_CARD_CHANGE (ID,
	CARDID,
	CARDOBJECTID,
	BIZID,
	BIZTYPE,
	BIZTIME,
	ORG,
	JIZRQ,
	ZICFL,
	SHIYBM,
	SHIYZK,
	SHIYR,
	QUDFS,
	YONGTFL,
	CHANQXS,
	QUANSXZ,
	JIAZLX,
	CHUZXS,
	CUNFDD,
	JIAZ,
	JIAZ_Z,
	JIAZ_J,
	SHUL,
	SHUL_Z,
	SHUL_J,
	MIANJ,
	MIANJ_Z,
	MIANJ_J,
	BIANZQK,
	JIAOYSYFX,
	HANGYFL,
	SORTGB,
	BIZCODE,
	JIZQJ,
	HANGYDL,
	GRADE,
	NATURE,
	ZICFL_D,
	SORTGB_D,
	HANGYFL_D,
	HANGYDL_D,
	SHIYBM_D,
	SHIYR_D,
	CUNFDD_D,
	JIAOYSYFX_D,
	SHIYZK_D,
	QUDFS_D,
	BIANZQK_D,
	YONGTFL_D,
	CHANQXS_D,
	QUANSXZ_D,
	JIAZLX_D,
	JINGFKM_D,
	CAOZSJ,
	XIAOJBGYF,
	XIAOJBGYF_Z,
	XIAOJBGYF_J,
	XIAOJQZBGSYF,
	XIAOJQZBGSYF_Z,
	XIAOJQZBGSYF_J,
	XIAOJYWYF,
	XIAOJYWYF_Z,
	XIAOJYWYF_J,
	XIAOJIQTYF,
	XIAOJIQTYF_Z,
	XIAOJIQTYF_J,
	HANGYFLNEW,
	BIANDCZSXH,
	ZICFLCODE,
	CAIWJZRQ,
	FINALBILLID)
SELECT
	ID,
	CARDID,
	CARDOBJECTID,
	BIZID,
	BIZTYPE,
	BIZTIME,
	ORG,
	JIZRQ,
	ZICFL,
	SHIYBM,
	SHIYZK,
	SHIYR,
	QUDFS,
	YONGTFL,
	CHANQXS,
	QUANSXZ,
	JIAZLX,
	CHUZXS,
	CUNFDD,
	JIAZ,
	JIAZ_Z,
	JIAZ_J,
	SHUL,
	SHUL_Z,
	SHUL_J,
	MIANJ,
	MIANJ_Z,
	MIANJ_J,
	BIANZQK,
	JIAOYSYFX,
	HANGYFL,
	SORTGB,
	BIZCODE,
	JIZQJ,
	HANGYDL,
	GRADE,
	NATURE,
	ZICFL_D,
	SORTGB_D,
	HANGYFL_D,
	HANGYDL_D,
	SHIYBM_D,
	SHIYR_D,
	CUNFDD_D,
	JIAOYSYFX_D,
	SHIYZK_D,
	QUDFS_D,
	BIANZQK_D,
	YONGTFL_D,
	CHANQXS_D,
	QUANSXZ_D,
	JIAZLX_D,
	JINGFKM_D,
	CAOZSJ,
	XIAOJBGYF,
	XIAOJBGYF_Z,
	XIAOJBGYF_J,
	XIAOJQZBGSYF,
	XIAOJQZBGSYF_Z,
	XIAOJQZBGSYF_J,
	XIAOJYWYF,
	XIAOJYWYF_Z,
	XIAOJYWYF_J,
	XIAOJIQTYF,
	XIAOJIQTYF_Z,
	XIAOJIQTYF_J,
	HANGYFLNEW,
	BIANDCZSXH,
	ZICFLCODE,
	CAIWJZRQ,
	FINALBILLID
FROM
	CQDZGCZYXY_ZCGL.GAMS_CARD_CHANGETEST;
	
--期初土地
UPDATE
	GAMS_CARD_CHANGE a
SET
	JIZRQ = (
	SELECT
		JIZRQ
	FROM
		GAMS_CARD gc
	WHERE
		gc.id = a.CARDID)
WHERE
	a.CARDID IN ('6ED50A1B40000221BACE6D9BC0952C4E',
	'6ED50A1B600003A146EBDD619F4617D0',
	'6ED50A1B400000A1003B8EFDF7208E33',
	'6ED50A1B60000221128DECE3723AAB8C',
	'6ED50A1B600000A19074166DCE260A4C',
	'6ED50A1B800002017DB80651A5CCA081',
	'6ED50A1B600001614931BB4470FF7AF5',
	'6ED50A1B800004413EFD31CF21D7B04A',
	'6ED50A1B800000813D826FE8F412D9C5',
	'6ED50A1B60000461D3E3D7244C7A68C8',
	'6ED50A1B200000014E1EFDEAD346BC34',
	'6ED50A1BA0000381BDC76DFD88D178E3',
	'6ED50A1BA000014177A29D6204C5925E',
	'6ED50A1B80000141F61EB0A2210217F4',
	'6ED50A1B800002C1D5C824ACB83B5543',
	'6ED50A1BA0000081E080A84E21C0063D',
	'6ED50A1B400001610DB15CEE9014C47D',
	'6ED50A1BA00002C139B89E6BAB21A63C',
	'6ED50A1BA0000201D0FABD5D51C03C9E',
	'6ED50A1B600002E1A13F02D991568E7C',
	'6ED50A1B80000381DC0ABA986499C710');

UPDATE
	GAMS_CARD_CHANGE a
SET
	JIZQJ = (
	SELECT
		JIZQJ
	FROM
		GAMS_CARD gc
	WHERE
		gc.id = a.CARDID)
WHERE
	a.CARDID IN ('6ED50A1B40000221BACE6D9BC0952C4E',
	'6ED50A1B600003A146EBDD619F4617D0',
	'6ED50A1B400000A1003B8EFDF7208E33',
	'6ED50A1B60000221128DECE3723AAB8C',
	'6ED50A1B600000A19074166DCE260A4C',
	'6ED50A1B800002017DB80651A5CCA081',
	'6ED50A1B600001614931BB4470FF7AF5',
	'6ED50A1B800004413EFD31CF21D7B04A',
	'6ED50A1B800000813D826FE8F412D9C5',
	'6ED50A1B60000461D3E3D7244C7A68C8',
	'6ED50A1B200000014E1EFDEAD346BC34',
	'6ED50A1BA0000381BDC76DFD88D178E3',
	'6ED50A1BA000014177A29D6204C5925E',
	'6ED50A1B80000141F61EB0A2210217F4',
	'6ED50A1B800002C1D5C824ACB83B5543',
	'6ED50A1BA0000081E080A84E21C0063D',
	'6ED50A1B400001610DB15CEE9014C47D',
	'6ED50A1BA00002C139B89E6BAB21A63C',
	'6ED50A1BA0000201D0FABD5D51C03C9E',
	'6ED50A1B600002E1A13F02D991568E7C',
	'6ED50A1B80000381DC0ABA986499C710');
	
	


--期初通用设备
CREATE TABLE c AS 
SELECT
	c.*
FROM
	gams_card c,
	(
	SELECT
		c2.objectid AS objectid,
		max(c2.yewxlh) AS yewxlh
	FROM
		gams_card c2
	WHERE
		c2.jizrq < to_date('2016-01-01 00:00:00', 'yyyy-mm-dd HH24:mi:ss')
		AND c2.orgunit = '6E35BC1F80000001F6D62BD49F8EC9CC'
	GROUP BY
		c2.objectid) c3
WHERE
	c.sortgb = '3711F12FC000000192E940E7FAE32E55'
	AND c.jizrq < to_date('2016-01-01 00:00:00', 'yyyy-mm-dd HH24:mi:ss')
	AND c.yewxlh = c3.yewxlh
	AND c.objectid = c3.objectid
	AND c.auditstate = 2
	AND c.cardstate LIKE '0%'
	AND c.orgunit = '6E35BC1F80000001F6D62BD49F8EC9CC'
	AND c.id NOT IN (SELECT
		CHANGE.CARDID 
	FROM
		GAMS_CARD_CHANGE  CHANGE
		LEFT JOIN GAMS_JC_ASSETSORT_GB gjag ON CHANGE.SORTGB = gjag.ID 
	WHERE
		change.sortgb IS NOT NULL
		AND change.jizrq < to_date('2016-01-01 00:00:00','yyyy-mm-dd HH24:mi:ss')
		AND CHANGE.ORG = '6E35BC1F80000001F6D62BD49F8EC9CC'
		AND CHANGE.SORTGB = '3711F12FC000000192E940E7FAE32E55');
	
	
	DELETE FROM CQDZGCZYXY_ZCGL.GAMS_CARD_CHANGE gcc WHERE gcc.cardid IN (SELECT id FROM c);
--	INSERT INTO CQDZGCZYXY_ZCGL.GAMS_CARD_CHANGE SELECT * FROM CQDZGCZYXY_ZCGL.GAMS_CARD_CHANGE_TEMP gcct WHERE gcct.CARDID IN (SELECT id FROM c);
	
drop table c;
--期末无形
UPDATE CQDZGCZYXY_ZCGL.GAMS_CARD_CHANGE SET SORTGB = '3711F12FC000000192E940E7FAE32E55' WHERE id = 'C0ECDF1E0F8447CA845203467150FAB5';


INSERT
	INTO
	CQDZGCZYXY_ZCGL.GAMS_CARD_CHANGE (ID,
	CARDID,
	CARDOBJECTID,
	BIZID,
	BIZTYPE,
	BIZTIME,
	ORG,
	JIZRQ,
	ZICFL,
	SHIYBM,
	SHIYZK,
	SHIYR,
	QUDFS,
	YONGTFL,
	CHANQXS,
	QUANSXZ,
	JIAZLX,
	CHUZXS,
	CUNFDD,
	JIAZ,
	JIAZ_Z,
	JIAZ_J,
	SHUL,
	SHUL_Z,
	SHUL_J,
	MIANJ,
	MIANJ_Z,
	MIANJ_J,
	BIANZQK,
	JIAOYSYFX,
	HANGYFL,
	SORTGB,
	BIZCODE,
	JIZQJ,
	HANGYDL,
	GRADE,
	NATURE,
	ZICFL_D,
	SORTGB_D,
	HANGYFL_D,
	HANGYDL_D,
	SHIYBM_D,
	SHIYR_D,
	CUNFDD_D,
	JIAOYSYFX_D,
	SHIYZK_D,
	QUDFS_D,
	BIANZQK_D,
	YONGTFL_D,
	CHANQXS_D,
	QUANSXZ_D,
	JIAZLX_D,
	JINGFKM_D,
	CAOZSJ,
	XIAOJBGYF,
	XIAOJBGYF_Z,
	XIAOJBGYF_J,
	XIAOJQZBGSYF,
	XIAOJQZBGSYF_Z,
	XIAOJQZBGSYF_J,
	XIAOJYWYF,
	XIAOJYWYF_Z,
	XIAOJYWYF_J,
	XIAOJIQTYF,
	XIAOJIQTYF_Z,
	XIAOJIQTYF_J,
	HANGYFLNEW,
	BIANDCZSXH,
	ZICFLCODE,
	CAIWJZRQ,
	FINALBILLID)
VALUES (SYS_GUID(),
'DBA1F1425947487480E266C703445781',
'DBA1F1425947487480E266C703445781',
'DBA1F1425947487480E266C703445781',
'com.jiuqi.np.gams2.business.bill.InspectionEntryBillDefine',
TIMESTAMP'2019-12-05 15:06:52.496',
'6E35BC1F80000001F6D62BD49F8EC9CC',
TIMESTAMP'2019-11-25 00:00:00',
'3AD9F95520001021D4B15EC546906859',
'6E35DEF1000000414E80B62FA6F5769E',
'5E5B480EC000000128A33A05401E5748',
'6E35E0BD6000014107A9F66E5E2356BB',
'36B91A2620000001112E65D5B88F4774',
NULL,
NULL,
NULL,
'36B908C8A00000016F9E6175B4B985DA',
NULL,
'6E392ECDE00006A174843EBA4879C7FD',
48840,
48840,
NULL,
1,
1,
NULL,
0,
0,
NULL,
NULL,
'3AB70BFC40000021A9A6A1A1175DC935',
'3AD9F95520001021D4B15EC546906859',
'3DCA958F0000002178673E76D0CE4984',
'JJ2019003966',
'201911',
'3AB9A1E240000181A09D48039A0F7282',
'1',
NULL,
'3755B56700000B011DFCADA627833B44',
'3755B56700000B011DFCADA627833B44',
'3AD9F95520001021D4B15EC546906859',
'3AB9A1E240000181A09D48039A0F7282',
'6E35DEF1000000414E80B62FA6F5769E',
'6E35E0BD6000014107A9F66E5E2356BB',
'6E392ECDE00006A174843EBA4879C7FD',
'3AB70BFC40000021A9A6A1A1175DC935',
NULL,
'36B91A2620000001112E65D5B88F4774',
NULL,
NULL,
NULL,
NULL,
'36B908C8A00000016F9E6175B4B985DA',
NULL,
TIMESTAMP'2020-03-18 13:39:48.901',
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
NULL);

--INSERT INTO CQDZGCZYXY_ZCGL.GAMS_CARD_CHANGE (ID,CARDID,CARDOBJECTID,BIZID,BIZTYPE,BIZTIME,ORG,JIZRQ,ZICFL,SHIYBM,SHIYZK,SHIYR,QUDFS,YONGTFL,CHANQXS,QUANSXZ,JIAZLX,CHUZXS,CUNFDD,JIAZ,JIAZ_Z,JIAZ_J,SHUL,SHUL_Z,SHUL_J,MIANJ,MIANJ_Z,MIANJ_J,BIANZQK,JIAOYSYFX,HANGYFL,SORTGB,BIZCODE,JIZQJ,HANGYDL,GRADE,NATURE,ZICFL_D,SORTGB_D,HANGYFL_D,HANGYDL_D,SHIYBM_D,SHIYR_D,CUNFDD_D,JIAOYSYFX_D,SHIYZK_D,QUDFS_D,BIANZQK_D,YONGTFL_D,CHANQXS_D,QUANSXZ_D,JIAZLX_D,JINGFKM_D,CAOZSJ,XIAOJBGYF,XIAOJBGYF_Z,XIAOJBGYF_J,XIAOJQZBGSYF,XIAOJQZBGSYF_Z,XIAOJQZBGSYF_J,XIAOJYWYF,XIAOJYWYF_Z,XIAOJYWYF_J,XIAOJIQTYF,XIAOJIQTYF_Z,XIAOJIQTYF_J,HANGYFLNEW,BIANDCZSXH,ZICFLCODE,CAIWJZRQ,FINALBILLID) VALUES
--	 (sys_guid(),'26F0D022B58146319EBFFAC497A7AE12','EA3F90F9D3DD4CC385CD578B9F48EE80','29320B09E4D742409AC4298F3DB9A202','com.jiuqi.np.gams2.business.bill.WithdrawBillDefine',TIMESTAMP'2020-09-28 09:39:13.677','6E35BC1F80000001F6D62BD49F8EC9CC',TIMESTAMP'2020-09-25 00:00:00','66C8BC4D00000001C72D9DB1D2BECDBE','6E35DEF140000061B633A57BFA16DED0','5E5B480EC000000128A33A05401E5748','6E35E0BF20000001278AD5E1C23FEC14','36B91A2620000001112E65D5B88F4774',NULL,NULL,NULL,'36B908C8A00000016F9E6175B4B985DA',NULL,NULL,9800,-9800,NULL,1,-1,NULL,0,0,NULL,NULL,'3AB70BFC40000021A9A6A1A1175DC935','66C8BC4D00000001C72D9DB1D2BECDBE','3DCA958F0000002178673E76D0CE4984','TKSQ2020000006','202009','3AF8EAD040000001C2BD309451B5B7AC','strict','sale','66C8BC4D00000001C72D9DB1D2BECDBE','3DCA958F0000002178673E76D0CE4984','66C8BC4D00000001C72D9DB1D2BECDBE','3AF8EAD040000001C2BD309451B5B7AC','6E35DEF140000061B633A57BFA16DED0','6E35E0BF20000001278AD5E1C23FEC14',NULL,'3AB70BFC40000021A9A6A1A1175DC935','5E5B480EC000000128A33A05401E5748','36B91A2620000001112E65D5B88F4774',NULL,NULL,NULL,NULL,'36B908C8A00000016F9E6175B4B985DA','48BA306840000001BB59F5B46FD08CC6',TIMESTAMP'2020-09-28 09:39:13.706',NULL,0,NULL,NULL,0,NULL,NULL,0,NULL,NULL,0,NULL,'B12ECF8897EA4A2A86B6118C45D63706',1,'6050633',NULL,'29320B09E4D742409AC4298F3DB9A202');



DELETE FROM CQDZGCZYXY_ZCGL.GAMS_CARD_CHANGE gcc WHERE gcc.id IN (SELECT ID FROM (SELECT
	*
FROM
	CQDZGCZYXY_ZCGL.gams_card_change CHANGE
WHERE
	change.jizrq <= to_date('2020-12-31 00:00:00', 'yyyy-mm-dd HH24:mi:ss')
	AND change.sortgb IS NOT NULL
	AND change.org = '6E35BC1F80000001F6D62BD49F8EC9CC'
	AND CHANGE.SORTGB = '3DCA958F0000002178673E76D0CE4984') a WHERE a.cardobjectid NOT IN (SELECT b.cardobjectid FROM (SELECT
	*
FROM
	CQS_ZCGL.GAMS_ASSETCARDCHANGE_NEW_0329 CHANGE
WHERE
	change.jizrq <= to_date('2020-12-31 00:00:00', 'yyyy-mm-dd HH24:mi:ss')
	AND change.SORTGBID IS NOT NULL
	AND CHANGE.ORGUNIT = '6E35BC1F80000001F6D62BD49F8EC9CC'
	AND CHANGE.SORTGBID = '3DCA958F0000002178673E76D0CE4984') b));
	
DELETE FROM GAMS_CARD gc WHERE gc.BILLCODE = 'RJ20171231000206';
DELETE FROM GAMS_CARD_WXZC gcw WHERE BILLCODE = 'RJ20171231000206';
	
--期末通用
DELETE
FROM
	CQDZGCZYXY_ZCGL.GAMS_CARD_CHANGE gcc
WHERE
	gcc.CARDID IN (
	SELECT
		CARDID
	FROM
		(SELECT
	*
FROM
	CQDZGCZYXY_ZCGL.gams_card_change CHANGE
WHERE
	change.jizrq <= to_date('2020-12-31 00:00:00', 'yyyy-mm-dd HH24:mi:ss')
	AND change.sortgb IS NOT NULL
	AND change.org = '6E35BC1F80000001F6D62BD49F8EC9CC'
	AND CHANGE.SORTGB = '3711F12FC000000192E940E7FAE32E55') a
	WHERE
		a.cardid NOT IN (
		SELECT
			b.cardrecid
		FROM
			(SELECT
	*
FROM
	CQS_ZCGL.GAMS_ASSETCARDCHANGE_NEW_0329 CHANGE
WHERE
	change.jizrq <= to_date('2020-12-31 00:00:00', 'yyyy-mm-dd HH24:mi:ss')
	AND change.SORTGBID IS NOT NULL
	AND CHANGE.ORGUNIT = '6E35BC1F80000001F6D62BD49F8EC9CC'
	AND CHANGE.SORTGBID = '3711F12FC000000192E940E7FAE32E55') b) );
	
--减少
--处理通用
UPDATE
	CQDZGCZYXY_ZCGL.GAMS_CARD
SET
	CAIWJZRQ = CAIWRZRQ
WHERE
	id IN (
	SELECT
		CARDRECID
	FROM
		(
		SELECT
			*
		FROM
			CQS_ZCGL.GAMS_ASSETCARDCHANGE_NEW_0329 bdcard
		WHERE
			bdcard.orgunit = '6E35BC1F80000001F6D62BD49F8EC9CC'
			AND (bdcard.SORTGBID IS NOT NULL)
			AND bdcard.JIZRQ >= to_date('2016-01-01 00:00:00', 'yyyy-mm-dd HH24:mi:ss')
			AND bdcard.JIZRQ <= to_date('2020-12-31 00:00:00', 'yyyy-mm-dd HH24:mi:ss')
			AND BDCARD.SORTGBID = '3711F12FC000000192E940E7FAE32E55')
	WHERE
		cardrecid NOT IN (
		SELECT
			cardid
		FROM
			(
			SELECT
				*
			FROM
				CQDZGCZYXY_ZCGL.GAMS_CARD_CHANGE bdcard
			WHERE
				bdcard.ORG = '6E35BC1F80000001F6D62BD49F8EC9CC'
				AND (bdcard.SORTGB IS NOT NULL)
				AND bdcard.CAIWJZRQ >= to_date('2016-01-01 00:00:00', 'yyyy-mm-dd HH24:mi:ss')
				AND bdcard.CAIWJZRQ <= to_date('2020-12-31 00:00:00', 'yyyy-mm-dd HH24:mi:ss')
				AND BDCARD.SORTGB = '3711F12FC000000192E940E7FAE32E55')));

--处理家具
CREATE TABLE czjsty AS 
select *
           from CQS_ZCGL.GAMS_ASSETCARDCHANGE_NEW_0329   bdcard 
           where bdcard.orgunit = '6E35BC1F80000001F6D62BD49F8EC9CC'
               and (bdcard.SORTGBID is not null)
                 and bdcard.JIZRQ >= to_date('2016-01-01 00:00:00','yyyy-mm-dd HH24:mi:ss')
                 and bdcard.JIZRQ <= to_date('2020-12-31 00:00:00','yyyy-mm-dd HH24:mi:ss')
           		AND BDCARD.SORTGBID = '3711F2B38000000196D90238154FE14D';
           	
 CREATE TABLE zcjsty AS 
		           select *
		           from CQDZGCZYXY_ZCGL.GAMS_CARD_CHANGE  bdcard 
		           where bdcard.ORG = '6E35BC1F80000001F6D62BD49F8EC9CC'
		               and (bdcard.SORTGB is not null)
		                 and bdcard.CAIWJZRQ >= to_date('2016-01-01 00:00:00','yyyy-mm-dd HH24:mi:ss')
		                 and bdcard.CAIWJZRQ <= to_date('2020-12-31 00:00:00','yyyy-mm-dd HH24:mi:ss')
		                 AND BDCARD.SORTGB = '3711F2B38000000196D90238154FE14D';
				
UPDATE CQDZGCZYXY_ZCGL.GAMS_CARD_CHANGE a SET CAIWJZRQ = (SELECT JIZRQ FROM czjsty b WHERE a.CARDID = b.CARDRECID) 

WHERE a.CARDID IN ('E84F7E75E8AD4305BBB07B0332BA7C4A',
'9F395B65C223484C98116726E008A2F8',
'E4EF4665AD0E44448C57881145E6D179',
'FCB978489CD3441AAE3012C4A2FC1680',
'9F6F03D3A7C34C7781665BDE6BF810E6',
'FC09F9337CB2417A8C0ADEB3486FBE8D',
'72466B147F66452BBF5F621BF9762C22',
'5437070A4525422A8E7738F0FD16CD5C',
'A007F49CC9834D96A1C099125ED72F5C',
'61A83DBB8ADA4CFE837410913C7AF1C4',
'03F8B742CF974991BDA5D1F5AA774557',
'EC6CFDB6D82D4307813C7A779B20FB2B',
'6C70D8E7D3164DCFB233A1FBECD8EF25',
'F6DBB13547E44FCF8E8EE9BB59007DE9',
'B06684A5121B443A99F90C34BC3BDB37');

UPDATE CQDZGCZYXY_ZCGL.GAMS_CARD_CHANGE a SET CAIWJZRQ = (SELECT CAIWJZRQ FROM CQDZGCZYXY_ZCGL.GAMS_CARD gc WHERE a.CARDID = gc.ID) WHERE a.CAIWJZRQ IS NULL ;
UPDATE CQDZGCZYXY_ZCGL.gams_card_change SET shul_j = abs(shul_z) WHERE BIZTYPE = 'com.jiuqi.np.gams2.business.bill.WithdrawBillDefine' AND CARDOBJECTID <> 'EA3F90F9D3DD4CC385CD578B9F48EE80';
UPDATE CQDZGCZYXY_ZCGL.gams_card_change SET jiaz_j = abs(jiaz_z) WHERE BIZTYPE = 'com.jiuqi.np.gams2.business.bill.WithdrawBillDefine' AND CARDOBJECTID <> 'EA3F90F9D3DD4CC385CD578B9F48EE80';
UPDATE CQDZGCZYXY_ZCGL.gams_card_change SET shul_z = NULL WHERE BIZTYPE = 'com.jiuqi.np.gams2.business.bill.WithdrawBillDefine' AND CARDOBJECTID <> 'EA3F90F9D3DD4CC385CD578B9F48EE80';
UPDATE CQDZGCZYXY_ZCGL.gams_card_change SET jiaz_z = NULL WHERE BIZTYPE = 'com.jiuqi.np.gams2.business.bill.WithdrawBillDefine' AND CARDOBJECTID <> 'EA3F90F9D3DD4CC385CD578B9F48EE80';

DROP TABLE czjsty;
DROP TABLE zcjsty;

--1、
UPDATE CQDZGCZYXY_ZCGL.GAMS_CARD_CHANGE gcc SET gcc.BIZTYPE = (SELECT BIZTYPE FROM CQDZGCZYXY_ZCGL_TEST.GAMS_CARD_CHANGE g WHERE g.id = gcc.id) WHERE gcc.BIZTYPE IS NULL ;
--2、
UPDATE CQDZGCZYXY_ZCGL.GAMS_CARD_CHANGE gcc SET gcc.BIZTYPE = (SELECT gc.BILLDEFINE FROM GAMS_CARD gc WHERE gc.id = gcc.CARDID) WHERE gcc.BIZTYPE IS NULL ;
--3
UPDATE CQDZGCZYXY_ZCGL.GAMS_CARD_CHANGE gcc SET gcc.NATURE = 'account_entry' WHERE BIZTYPE = 'TYSB' OR BIZTYPE = 'WXZC_RJ' OR BIZTYPE = 'JJYJZJ';
--4、
UPDATE CQDZGCZYXY_ZCGL.GAMS_CARD_CHANGE gcc SET gcc.NATURE = 'account_entry' WHERE NATURE IS NULL;
--5、
UPDATE CQDZGCZYXY_ZCGL.GAMS_CARD_CHANGE gcc SET BIZTYPE = 'com.jiuqi.np.gams2.core.gams_card_wxzc_rj' WHERE BIZTYPE = 'WXZC_RJ';
UPDATE CQDZGCZYXY_ZCGL.GAMS_CARD_CHANGE gcc SET BIZTYPE = 'com.jiuqi.np.gams2.core.gams_card_jjyjzj' WHERE BIZTYPE = 'JJYJZJ';
UPDATE CQDZGCZYXY_ZCGL.GAMS_CARD_CHANGE gcc SET BIZTYPE = 'com.jiuqi.np.gams2.core.gams_card_tysb' WHERE BIZTYPE = 'TYSB';

INSERT
	INTO
	CQDZGCZYXY_ZCGL.GAMS_CARD_CHANGE (ID,
	CARDID,
	CARDOBJECTID,
	BIZID,
	BIZTYPE,
	BIZTIME,
	ORG,
	JIZRQ,
	ZICFL,
	SHIYBM,
	SHIYZK,
	SHIYR,
	QUDFS,
	YONGTFL,
	CHANQXS,
	QUANSXZ,
	JIAZLX,
	CHUZXS,
	CUNFDD,
	JIAZ,
	JIAZ_Z,
	JIAZ_J,
	SHUL,
	SHUL_Z,
	SHUL_J,
	MIANJ,
	MIANJ_Z,
	MIANJ_J,
	BIANZQK,
	JIAOYSYFX,
	HANGYFL,
	SORTGB,
	BIZCODE,
	JIZQJ,
	HANGYDL,
	GRADE,
	NATURE,
	ZICFL_D,
	SORTGB_D,
	HANGYFL_D,
	HANGYDL_D,
	SHIYBM_D,
	SHIYR_D,
	CUNFDD_D,
	JIAOYSYFX_D,
	SHIYZK_D,
	QUDFS_D,
	BIANZQK_D,
	YONGTFL_D,
	CHANQXS_D,
	QUANSXZ_D,
	JIAZLX_D,
	JINGFKM_D,
	CAOZSJ,
	XIAOJBGYF,
	XIAOJBGYF_Z,
	XIAOJBGYF_J,
	XIAOJQZBGSYF,
	XIAOJQZBGSYF_Z,
	XIAOJQZBGSYF_J,
	XIAOJYWYF,
	XIAOJYWYF_Z,
	XIAOJYWYF_J,
	XIAOJIQTYF,
	XIAOJIQTYF_Z,
	XIAOJIQTYF_J,
	HANGYFLNEW,
	BIANDCZSXH,
	ZICFLCODE,
	CAIWJZRQ,
	FINALBILLID)
VALUES (SYS_GUID(),
'DBA1F1425947487480E266C703445781',
'DBA1F1425947487480E266C703445781',
'DBA1F1425947487480E266C703445781',
'com.jiuqi.np.gams2.business.bill.InspectionEntryBillDefine',
TIMESTAMP'2019-12-05 15:06:52.496',
'6E35BC1F80000001F6D62BD49F8EC9CC',
TIMESTAMP'2019-11-25 00:00:00',
'3AD9F95520001021D4B15EC546906859',
'6E35DEF1000000414E80B62FA6F5769E',
'5E5B480EC000000128A33A05401E5748',
'6E35E0BD6000014107A9F66E5E2356BB',
'36B91A2620000001112E65D5B88F4774',
NULL,
NULL,
NULL,
'36B908C8A00000016F9E6175B4B985DA',
NULL,
'6E392ECDE00006A174843EBA4879C7FD',
48840,
48840,
NULL,
1,
1,
NULL,
0,
0,
NULL,
NULL,
'3AB70BFC40000021A9A6A1A1175DC935',
'3AD9F95520001021D4B15EC546906859',
'3DCA958F0000002178673E76D0CE4984',
'JJ2019003966',
'201911',
'3AB9A1E240000181A09D48039A0F7282',
'1',
NULL,
'3755B56700000B011DFCADA627833B44',
'3755B56700000B011DFCADA627833B44',
'3AD9F95520001021D4B15EC546906859',
'3AB9A1E240000181A09D48039A0F7282',
'6E35DEF1000000414E80B62FA6F5769E',
'6E35E0BD6000014107A9F66E5E2356BB',
'6E392ECDE00006A174843EBA4879C7FD',
'3AB70BFC40000021A9A6A1A1175DC935',
NULL,
'36B91A2620000001112E65D5B88F4774',
NULL,
NULL,
NULL,
NULL,
'36B908C8A00000016F9E6175B4B985DA',
NULL,
TIMESTAMP'2020-03-18 13:39:48.901',
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
NULL);


UPDATE GAMS_CARD_CHANGE SET NATURE = 'process'WHERE JIAZ = 48840;


DELETE FROM GAMS_CARD_CHANGE gcc WHERE gcc.BIZTYPE = 'com.jiuqi.np.gams2.business.bill.AssetsplitBillDefine';